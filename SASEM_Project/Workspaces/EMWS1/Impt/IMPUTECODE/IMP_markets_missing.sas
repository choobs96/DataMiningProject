*;
* IMPUTE VARIABLE: markets_missing;
*;
format IMP_markets_missing BEST12.0;
label IMP_markets_missing = 'Imputed markets_missing';
IMP_markets_missing = markets_missing;
if missing(IMP_markets_missing) then do;
****************************************************************;
****** DECISION TREE SCORING CODE ******;
****************************************************************;
****** LENGTHS OF NEW CHARACTER VARIABLES ******;
LENGTH I_markets_missing $ 12;
LENGTH _WARN_ $ 4;
****** LABELS FOR NEW VARIABLES ******;
label P_markets_missing0 = 'Predicted: markets_missing=0';
label P_markets_missing1 = 'Predicted: markets_missing=1';
label Q_markets_missing0 = 'Unadjusted P: markets_missing=0';
label Q_markets_missing1 = 'Unadjusted P: markets_missing=1';
label I_markets_missing = 'Into: markets_missing';
label U_markets_missing = 'Unnormalized Into: markets_missing';
label _WARN_ = 'Warnings';
****** TEMPORARY VARIABLES FOR FORMATTED VALUES ******;
LENGTH _ARBFMT_12 $ 12;
DROP _ARBFMT_12;
_ARBFMT_12 = ' ';
/* Initialize to avoid warning. */
****** ASSIGN OBSERVATION TO NODE ******;
DROP _BRANCH_;
_BRANCH_ = -1;
IF NOT MISSING(foreign_gross ) AND
foreign_gross < 296753.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(foreign_gross ) AND
296753.5 <= foreign_gross THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 323491.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 323491.5 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(domestic_gross ) THEN DO;
IF domestic_gross < 253529 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 253529 <= domestic_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(foreign_gross ) AND
foreign_gross < 37542 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(foreign_gross ) AND
37542 <= foreign_gross THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 61023 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 61023 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(tomatometer_count ) THEN DO;
IF tomatometer_count < 110.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 110.5 <= tomatometer_count THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(domestic_opening ) AND
domestic_opening < 1625 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(domestic_opening ) AND
1625 <= domestic_opening THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(domestic_gross ) THEN DO;
IF domestic_gross < 3689.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 3689.5 <= domestic_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 290375 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 290375 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
_BRANCH_ = -1;
_ARBFMT_12 = PUT( NR , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(R ) THEN DO;
_ARBFMT_12 = PUT( R , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(user_rating_count ) THEN DO;
IF 813.5 <= user_rating_count THEN DO;
_BRANCH_ = 1;
END;
ELSE IF user_rating_count < 813.5 THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 1;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
P_markets_missing0 = 0.41237113402061;
P_markets_missing1 = 0.58762886597938;
Q_markets_missing0 = 0.41237113402061;
Q_markets_missing1 = 0.58762886597938;
I_markets_missing = '1';
U_markets_missing = 1;
END;
ELSE DO;
P_markets_missing0 = 0.61963190184049;
P_markets_missing1 = 0.3803680981595;
Q_markets_missing0 = 0.61963190184049;
Q_markets_missing1 = 0.3803680981595;
I_markets_missing = '0';
U_markets_missing = 0;
END;
END;
ELSE DO;
_BRANCH_ = -1;
IF NOT MISSING(domestic_gross ) AND
domestic_gross < 112976.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(domestic_gross ) AND
112976.5 <= domestic_gross THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 421426 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 421426 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
P_markets_missing0 = 0.6;
P_markets_missing1 = 0.4;
Q_markets_missing0 = 0.6;
Q_markets_missing1 = 0.4;
I_markets_missing = '0';
U_markets_missing = 0;
END;
ELSE DO;
P_markets_missing0 = 0.1103448275862;
P_markets_missing1 = 0.88965517241379;
Q_markets_missing0 = 0.1103448275862;
Q_markets_missing1 = 0.88965517241379;
I_markets_missing = '1';
U_markets_missing = 1;
END;
END;
END;
ELSE DO;
P_markets_missing0 = 0.0187969924812;
P_markets_missing1 = 0.98120300751879;
Q_markets_missing0 = 0.0187969924812;
Q_markets_missing1 = 0.98120300751879;
I_markets_missing = '1';
U_markets_missing = 1;
END;
END;
ELSE DO;
_BRANCH_ = -1;
IF NOT MISSING(domestic_opening ) AND
domestic_opening < 36 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(domestic_opening ) AND
36 <= domestic_opening THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(domestic_gross ) THEN DO;
IF domestic_gross < 36 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 36 <= domestic_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 892725.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 892725.5 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
_BRANCH_ = -1;
_ARBFMT_12 = PUT( NR , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(R ) THEN DO;
_ARBFMT_12 = PUT( R , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(ss_p25 ) THEN DO;
IF 0.125 <= ss_p25 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF ss_p25 < 0.125 THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 1;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(foreign_gross ) AND
foreign_gross < 3872704 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(foreign_gross ) AND
3872704 <= foreign_gross THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 3872704 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 3872704 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(genre_AnimationManga ) THEN DO;
_ARBFMT_12 = PUT( genre_AnimationManga , BEST12.);
%DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('0' ) THEN DO;
_BRANCH_ = 1;
END;
ELSE IF _ARBFMT_12 IN ('1' ) THEN DO;
_BRANCH_ = 2;
END;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
P_markets_missing0 = 0.71830985915492;
P_markets_missing1 = 0.28169014084507;
Q_markets_missing0 = 0.71830985915492;
Q_markets_missing1 = 0.28169014084507;
I_markets_missing = '0';
U_markets_missing = 0;
END;
ELSE DO;
P_markets_missing0 = 0.3625730994152;
P_markets_missing1 = 0.63742690058479;
Q_markets_missing0 = 0.3625730994152;
Q_markets_missing1 = 0.63742690058479;
I_markets_missing = '1';
U_markets_missing = 1;
END;
END;
ELSE DO;
P_markets_missing0 = 0.25968992248062;
P_markets_missing1 = 0.74031007751937;
Q_markets_missing0 = 0.25968992248062;
Q_markets_missing1 = 0.74031007751937;
I_markets_missing = '1';
U_markets_missing = 1;
END;
END;
ELSE DO;
_BRANCH_ = -1;
IF NOT MISSING(tomatometer_count ) AND
tomatometer_count < 48.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(tomatometer_count ) AND
48.5 <= tomatometer_count THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(ss_count ) THEN DO;
IF ss_count < 48.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 48.5 <= ss_count THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(user_rating_count ) THEN DO;
IF user_rating_count < 909.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 909.5 <= user_rating_count THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
P_markets_missing0 = 0.82628062360801;
P_markets_missing1 = 0.17371937639198;
Q_markets_missing0 = 0.82628062360801;
Q_markets_missing1 = 0.17371937639198;
I_markets_missing = '0';
U_markets_missing = 0;
END;
ELSE DO;
_BRANCH_ = -1;
IF NOT MISSING(foreign_gross ) AND
foreign_gross < 2483604.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(foreign_gross ) AND
2483604.5 <= foreign_gross THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 3868970 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 3868970 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(markets ) THEN DO;
IF markets < 17.5 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 17.5 <= markets THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 2;
IF _BRANCH_ EQ 1 THEN DO;
_BRANCH_ = -1;
IF NOT MISSING(domestic_opening ) AND
domestic_opening < 11588026 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF NOT MISSING(domestic_opening ) AND
11588026 <= domestic_opening THEN DO;
_BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(domestic_gross ) THEN DO;
IF domestic_gross < 39556941 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 39556941 <= domestic_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 AND NOT MISSING(total_gross ) THEN DO;
IF total_gross < 41137441 THEN DO;
_BRANCH_ = 1;
END;
ELSE IF 41137441 <= total_gross THEN DO;
_BRANCH_ = 2;
END;
ELSE _BRANCH_ = 2;
END;
IF _BRANCH_ LT 0 THEN _BRANCH_ = 1;
IF _BRANCH_ EQ 2 THEN DO;
P_markets_missing0 = 0.33333333333333;
P_markets_missing1 = 0.66666666666666;
Q_markets_missing0 = 0.33333333333333;
Q_markets_missing1 = 0.66666666666666;
I_markets_missing = '1';
U_markets_missing = 1;
END;
ELSE DO;
P_markets_missing0 = 0.92222222222222;
P_markets_missing1 = 0.07777777777777;
Q_markets_missing0 = 0.92222222222222;
Q_markets_missing1 = 0.07777777777777;
I_markets_missing = '0';
U_markets_missing = 0;
END;
END;
ELSE DO;
P_markets_missing0 = 0.9902629016553;
P_markets_missing1 = 0.00973709834469;
Q_markets_missing0 = 0.9902629016553;
Q_markets_missing1 = 0.00973709834469;
I_markets_missing = '0';
U_markets_missing = 0;
END;
END;
END;
END;
****************************************************************;
****** END OF DECISION TREE SCORING CODE ******;
****************************************************************;
*;
* ASSIGN VALUE TO: markets_missing;
*;
length _format200 $200;
drop _format200;
_format200 = strip(I_markets_missing);
if _format200="1" then IMP_markets_missing = 1;
else
if _format200="0" then IMP_markets_missing = 0;
END;
